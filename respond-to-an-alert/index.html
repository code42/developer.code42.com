
<!doctype html>
<html>
  <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-H911T08KR9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-H911T08KR9');
  </script>

    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="../images/favicon-430ccdd6.ico" rel="icon" type="image/ico" />
    <title>Respond to an alert</title>
    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sa, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="../stylesheets/screen-7d631313.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print-951aa15b.css" rel="stylesheet" media="print" />
    <link rel="stylesheet" href="https://use.typekit.net/sxu2uqu.css">
      <script src="../javascripts/all-0c8f7524.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="respond-to-an-alert respond-to-an-alert_index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="" />
      </span>
    </a>
    <nav class="top-nav">
    <div class="nav-logo">
        <a href="/">
            <img src="../images/logo_developers-eb7c289e.svg" class="logo" alt="" />
        </a>
    </div>
    <div class="nav-menu">
        <div class="nav-item">
            <a href="#">Guides</a>
            <ul class="drop-menu">
                <li><a href="/forensic-search-api/">Forensic Search</a></li>
                <li><a href="/security-alerts-api/">Security Alerts</a></li>
                <li><a href="/respond-to-an-alert/">Respond to an Alert</a></li>
            </ul>
        </div>
        <div class="nav-item">
            <a href="#">APIs & SDK</a>
            <ul class="drop-menu">
                <li><a href="/api">API Reference</a></li>
                <li><a href="https://py42docs.code42.com" target="_blank">Py42</a></li>
                <li><a href="https://clidocs.code42.com" target="_blank">CLI</a></li>
            </ul>
        </div>
    </ul>
</nav>

      <div class="toc-wrapper">
          <div class="search">
            <input type="text" class="search" id="input-search" placeholder="Search">
          </div>
          <ul class="search-results"></ul>
        <ul id="toc" class="toc-list-h1">
            <li>
              <a href="#respond-to-an-alert" class="toc-h1 toc-link" data-title="Respond to an alert">Respond to an alert</a>
                <ul class="toc-list-h2">
                    <li>
                      <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                    </li>
                    <li>
                      <a href="#considerations" class="toc-h2 toc-link" data-title="Considerations">Considerations</a>
                    </li>
                    <li>
                      <a href="#before-you-begin" class="toc-h2 toc-link" data-title="Before you begin">Before you begin</a>
                      <ul class="toc-list-h3">
                          <li>
                              <a href="#set-up-monitoring-and-alerts" class="toc-h3 toc-link" data-title="Set up monitoring and alerts">Set up monitoring and alerts</a>
                          </li>
                          <li>
                              <a href="#plan-your-work" class="toc-h3 toc-link" data-title="Plan your work">Plan your work</a>
                          </li>
                          <li>
                              <a href="#gather-your-inputs" class="toc-h3 toc-link" data-title="Gather your inputs">Gather your inputs</a>
                          </li>
                      </ul>
                    </li>
                    <li>
                      <a href="#steps" class="toc-h2 toc-link" data-title="Steps">Steps</a>
                      <ul class="toc-list-h3">
                          <li>
                              <a href="#search-for-significant-alerts" class="toc-h3 toc-link" data-title="Search for significant alerts">Search for significant alerts</a>
                          </li>
                          <li>
                              <a href="#view-alert-details" class="toc-h3 toc-link" data-title="View alert details">View alert details</a>
                          </li>
                          <li>
                              <a href="#look-for-the-files-involved-in-the-alert" class="toc-h3 toc-link" data-title="Look for the files involved in the alert">Look for the files involved in the alert</a>
                          </li>
                          <li>
                              <a href="#open-a-case" class="toc-h3 toc-link" data-title="Open a case">Open a case</a>
                          </li>
                          <li>
                              <a href="#add-file-events-to-the-case" class="toc-h3 toc-link" data-title="Add file events to the case">Add file events to the case</a>
                          </li>
                      </ul>
                    </li>
                </ul>
            </li>
        </ul>
      </div>
    <div class="page-wrapper">
      <div class="content">
        <h1 id='respond-to-an-alert'>Respond to an alert</h1><h2 id='overview'>Overview</h2>
<p>You can use the Code42 APIs to respond to a high-value alert and add it to a case for further investigation. This article provides a use case showing how to use the APIs to:</p>

<ol>
<li>Search alerts to find one of interest.</li>
<li>View the alert&#39;s details.</li>
<li>Open a case.</li>
<li>Add file events from the alert to the case.</li>
</ol>

<p>For more information about the APIs described in this article, see:</p>

<ul>
<li><a href="/security-alerts-api/#security-alerts-api">Security alerts API</a></li>
<li><a href="/forensic-search-api/#forensic-search-api">Forensic Search API</a></li>
</ul>
<h2 id='considerations'>Considerations</h2>
<ul>
<li>The tasks in this article require use of the Code42 API. For assistance with using the Code42 API, contact your Customer Success Manager (CSM) to engage the Code42 Professional Services team. Or, <a href="https://success.code42.com/home">post your question to the Code42 community</a> to get advice from fellow Code42 administrators.</li>
<li>The examples in this article use <a href="https://curl.se/">curl</a>.</li>
<li>To perform tasks in this article, you must:

<ul>
<li>Know the <a href="/api/#section/Getting-started/Request-URLs">request URL</a> of your Code42 cloud instance.</li>
<li>Obtain an <a href="/api/#section/Getting-started/Authentication">authentication token</a> and a <a href="/api/#section/Getting-started/Get-a-tenant-ID">tenant ID</a>.</li>
</ul></li>
<li>This functionality is available only if your <a href="https://support.code42.com/Terms_and_conditions/Code42_customer_support_resources/Code42_product_plans">product plan</a> includes alerts. Contact your Customer Success Manager (CSM) for assistance with licensing, or to upgrade to the Incydr Advanced product plan for a free trial​​​. If you don&#39;t know who your CSM is, email <a href="mailto:csmsupport@code42.com">csmsupport@code42.com</a>.</li>
<li>To investigate file activity exposed by alerts, you must have <a href="https://support.code42.com/Administrator/Cloud/Monitoring_and_managing/Role_assignment_use_cases#Use_case_2:_Investigate_suspicious_file_activity">roles that provide the necessary permissions</a>.</li>
<li>You can also use the Code42 command-line interface (CLI) to work with alerts. For more information, see the <a href="https://clidocs.code42.com/en/latest/commands/alerts.html">Code42 CLI documentation</a>.</li>
</ul>
<h2 id='before-you-begin'>Before you begin</h2><h3 id='set-up-monitoring-and-alerts'>Set up monitoring and alerts</h3>
<p>Before you can receive alerts about employees&#39; file activity, do the following:</p>

<ul>
<li>Enable endpoint monitoring.
See <a href="https://support.code42.com/Administrator/Cloud/Configuring/Endpoint_monitoring">Enable endpoint monitoring for file exfiltration detection</a>.</li>
<li>Create rules to alert you when suspicious file activity occurs.
To create alert rules with the Code42 console, see <a href="https://support.code42.com/Administrator/Cloud/Monitoring_and_managing/How_to_create_a_security_alert">Create and manage alerts</a>. You can also <a href="/security-alerts-api/#manage-alert-rule-user-lists">manage rules with the rules API</a>.</li>
<li>(Optional) Set up additional monitoring to capture file activity.
See the following articles:

<ul>
<li><a href="https://support.code42.com/Administrator/Cloud/Monitoring_and_managing/Detect_and_respond_to_insider_threats#Part_1:_Capture_file_activity">Detect and respond to insider threats</a></li>
<li><a href="https://support.code42.com/Administrator/Cloud/Code42_console_reference/Data_Preferences_reference">Data Preferences reference</a></li>
<li><a href="https://support.code42.com/Administrator/Cloud/Configuring/Introduction_to_adding_data_connections">Introduction to adding data connections</a></li>
</ul></li>
</ul>
<h3 id='plan-your-work'>Plan your work</h3>
<p>Before you start writing scripts to handle alerts using the Code42 APIs, consider the following questions to help you plan your work:</p>

<p><strong>Why do you want to automate responding to alerts?</strong></p>

<p>Using APIs to automatically respond to alerts provides economies of scale. If you monitor insider risk at a small company, you could <a href="https://support.code42.com/Administrator/Cloud/Code42_console_reference/Alerts_reference">use the the Code42 console</a> to receive notifications about suspicious file activity. But for larger companies with many more employees to track, automating the process with the Code42 APIs provides a faster and more efficient method. As an added benefit, you can <a href="https://support.code42.com/Administrator/Cloud/Monitoring_and_managing/Code42_integrations_resources">integrate the Code42 APIs</a> with other systems such as your company&#39;s security tools. Planning and implementing Code42 APIs can take some time. Before you begin using Code42 APIs to manage alerts, consider the effort involved to set them up against the time savings provided when they run.</p>

<p><strong>What are the kinds of alerts you want to receive?</strong></p>

<p>You want to receive alerts when users perform actions that are considered high risk. Determine the kinds of actions that you want to receive alerts about and then <a href="https://support.code42.com/Administrator/Cloud/Monitoring_and_managing/How_to_create_a_security_alert">create alerts</a> that will be triggered by those actions. Creating the right kinds of alerts provides the best monitoring possible of high risk file activity.</p>
<h3 id='gather-your-inputs'>Gather your inputs</h3>
<p>Before attempting to write scripts using the Code42 API examples in this article, gather the following inputs:</p>

<ul>
<li><strong>Authentication token</strong></li>
</ul>

<p><a href="/api/#section/Getting-started/Authentication">Authentication tokens</a> are required to run the APIs. The tokens must be generated by a Code42 administrator with the proper <a href="https://support.code42.com/Administrator/Cloud/Monitoring_and_managing/Role_assignment_use_cases">role assignments</a>.</p>

<ul>
<li><strong>Tenant ID</strong></li>
</ul>

<p>Your company&#39;s entity in the Code42 cloud is known as a &quot;tenant&quot;. To obtain your <a href="/api/#section/Getting-started/Get-a-tenant-ID">tenant ID</a>, submit a request to the <a href="/api/#tag/Customer">customer API</a>.</p>

<ul>
<li><strong>Code42 usernames for the people you want to add to alert rules</strong></li>
</ul>

<p>The names of employees you want to add to alert rules may come from a number of sources, such as an HR system or a directory service. While you can integrate with such systems using the Code42 API, remember that you need the Code42 username of these employees to be able to add them to alerts. The Code42 username is assigned when the user is <a href="https://support.code42.com/Administrator/Cloud/Configuring/Add_users_from_the_Code42_console#Add_users_manually">added to Code42</a>. You can obtain usernames via <a href="https://support.code42.com/Administrator/Cloud/Code42_console_reference/Users_reference#CSV_export">CSV export</a>, <a href="https://support.code42.com/Administrator/Cloud/Code42_console_reference/User_Backup_report_reference#User_Backup_report">user reports</a>, or the <a href="/api/#section/Getting-started/Get-userUIDs">user API</a>.</p>
<h2 id='steps'>Steps</h2><h3 id='search-for-significant-alerts'>Search for significant alerts</h3>
<p>Alerts are an excellent way to get notifications about suspicious file activity. However, sometimes it can be difficult to separate the truly important ones from the rest.
To find alerts that are worthy of further investigation, use the <a href="/api/#operation/Alerts_QueryAlert">/v1/alerts/query-alerts</a> API command to search for alert notifications by alert filter criteria. By using filters you can uncover only the alerts that you want to follow up on.</p>
<div class="highlight"><pre class="highlight shell"><code>curl <span class="nt">-X</span> POST <span class="s2">"&lt;RequestURL&gt;/v1/alerts/query-alerts"</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"accept: text/plain"</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"Authorization: Bearer &lt;AuthToken&gt;"</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
<span class="nt">-d</span> <span class="s1">'{
  "tenantId": "&lt;SampleTenant&gt;",
  "groups": [
    {
      "filters": [
        {
          "term": "&lt;FilterType&gt;",
          "operator": "&lt;OperatorValue&gt;",
          "value": "&lt;Criteria&gt;"
        }
      ],
      "filterClause": "AND"
    }
  ],
  "groupClause": "OR",
  "pgSize": "20",
  "pgNum": "0",
  "srtKey": "CreatedAt",
  "srtDirection": "DESC"
}'</span>
</code></pre></div>
<p>In the preceding example:</p>

<ul>
<li>Replace <code>&lt;RequestURL&gt;</code> with the <a href="/api/#section/Getting-started/Request-URLs">request URL</a> of your Code42 cloud instance.</li>
<li>Replace <code>&lt;AuthToken&gt;</code> with the <a href="/api/#section/Getting-started/Authentication">authentication token</a>.</li>
<li>Replace <code>&lt;SampleTenant&gt;</code> with the <a href="/api/#section/Getting-started/Get-a-tenant-ID">tenant ID</a>.</li>
<li>For the <a href="/security-alerts-api/#filter-syntax-for-the-query-alerts-api-command">filter syntax</a>, replace <code>&lt;FilterType&gt;</code> with the filter, <code>&lt;OperatorValue&gt;</code> with the operator option, and <code>&lt;Criteria&gt;</code> with the search term to use in the search.</li>
</ul>

<p>A successful response returns basic information about the alert notifications that match your search criteria, including the alert IDs of notifications returned by the query (look for the &quot;id&quot; entry):</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"type$"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ALERT_SUMMARY"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"tenantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FED_ENDPOINT_EXFILTRATION"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Departing employee endpoint exfiltration system rule"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"System rule for departing employee endpoint exfiltration."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"actor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"burt.morales@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N/A"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"severity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ruleId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789424242"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ruleSource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Departing Employee"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"987654321424242"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-04-03T15:21:44.6139300Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPEN"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"totalCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"problems"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Note:</strong> You can further filter alerts by adding more <a href="/security-alerts-api/#filter-syntax-for-the-query-alerts-api-command">filter types</a> to your query. For example, you could use the Severity filter to find only those alerts that were high severity, or the RuleName filter to find only alerts from a particular rule.</p>
<h3 id='view-alert-details'>View alert details</h3>
<p>After you&#39;ve located the ID for an alert you want to investigate further, use the <a href="/api/#operation/Alerts_QueryAlertDetails">/v1/alerts/query-details</a> API command to view details about the alert, including the files involved in the file events that triggered the alert.</p>
<div class="highlight"><pre class="highlight shell"><code>curl <span class="nt">-X</span> POST <span class="s2">"&lt;RequestURL&gt;/v1/alerts/query-details"</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"accept: text/plain"</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"Authorization: Bearer &lt;AuthToken&gt;"</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
<span class="nt">-d</span> <span class="s1">'{ "alertIds": [ "&lt;SampleAlertID&gt;" ]}'</span>
</code></pre></div>
<p>In the preceding example:</p>

<ul>
<li>Replace <code>&lt;RequestURL&gt;</code> with the <a href="/api/#section/Getting-started/Request-URLs">request URL</a> of your Code42 cloud instance.</li>
<li>Replace <code>&lt;AuthToken&gt;</code> with the <a href="/api/#section/Getting-started/Authentication">authentication token</a>.</li>
<li>Replace <code>&lt;SampleAlertID&gt;</code> with the ID of an alert notification listed in the response in the &quot;<a href="#search-for-significant-alerts">Search for significant alerts</a>&quot; section above.</li>
</ul>

<p>A successful response returns full details about the alert notification, including event IDs (look for &quot;eventid&quot;) and a list of files involved in the event (look for &quot;files&quot; followed by &quot;name&quot;).</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"type$"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ALERT_DETAILS_RESPONSE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"alerts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type$"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ALERT_DETAILS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tenantId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FED_ENDPOINT_EXFILTRATION"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Departing employee endpoint exfiltration system rule"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"System rule for departing employee endpoint exfiltration."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"actor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"burt.morales@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N/A"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"severity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ruleId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789424242"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ruleSource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Departing Employee"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"987654321424242"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-04-08T13:50:25.3644410Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPEN"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"observations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type$"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OBSERVATION"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"112233445566"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"observedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-04-08T13:40:00.0000000Z"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FedEndpointExfiltration"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">type$</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">OBSERVED_ENDPOINT_ACTIVITY</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">id</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">665544332211</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">sources</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">Endpoint</span><span class="se">\"</span><span class="s2">],</span><span class="se">\"</span><span class="s2">exposureTypes</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">ApplicationRead</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">CloudStorage</span><span class="se">\"</span><span class="s2">],</span><span class="se">\"</span><span class="s2">firstActivityAt</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">2020-04-08T13:40:00.0000000Z</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">lastActivityAt</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">2020-04-08T13:45:00.0000000Z</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">fileCount</span><span class="se">\"</span><span class="s2">:2,</span><span class="se">\"</span><span class="s2">totalFileSize</span><span class="se">\"</span><span class="s2">:311096,</span><span class="se">\"</span><span class="s2">fileCategories</span><span class="se">\"</span><span class="s2">:[{</span><span class="se">\"</span><span class="s2">type$</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">OBSERVED_FILE_CATEGORY</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">category</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Image</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">fileCount</span><span class="se">\"</span><span class="s2">:2,</span><span class="se">\"</span><span class="s2">totalFileSize</span><span class="se">\"</span><span class="s2">:311096,</span><span class="se">\"</span><span class="s2">isSignificant</span><span class="se">\"</span><span class="s2">:false}],</span><span class="se">\"</span><span class="s2">files</span><span class="se">\"</span><span class="s2">:[{</span><span class="se">\"</span><span class="s2">type$</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">OBSERVED_FILE</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">eventId</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">998877665544</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">path</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">C:/Users/burt.morales/</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">1586353274_family_photo.png</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">category</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Image</span><span class="se">\"</span><span class="s2">},],</span><span class="se">\"</span><span class="s2">syncToServices</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">Dropbox</span><span class="se">\"</span><span class="s2">],</span><span class="se">\"</span><span class="s2">sendingIpAddresses</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">192.0.2.0</span><span class="se">\"</span><span class="s2">]}"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='look-for-the-files-involved-in-the-alert'>Look for the files involved in the alert</h3>
<p>Use the <a href="/forensic-search-api">Forensic Search APIs</a> to look for the files identified in the preceding alert query response.
The following Forensic Search API <a href="/forensic-search-api/#sample-request">sample request</a> using the <a href="/api/#operation/searchEventsUsingPOST">/v1/file-events</a> API command demonstrates a search for all files on all devices with the file extension <strong>.docx</strong> that exist anywhere in the file path <strong>C:/Users</strong>. Use this simple example as a starting point for your own searches and replace the content of the -d section with your specific search criteria.</p>
<div class="highlight"><pre class="highlight shell"><code>curl <span class="nt">-X</span> POST  &lt;RequestURL&gt;/v1/file-events <span class="se">\</span>
<span class="nt">-H</span> <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"authorization: Bearer &lt;AuthToken&gt;"</span> <span class="se">\</span>
<span class="nt">-d</span> <span class="s1">'{
  "groups": [
    {
      "filters": [
        {
          "operator": "IS",
          "term": "fileName",
          "value": "*.docx"
        },
        {
          "operator": "IS",
          "term": "filePath",
          "value": "C:/Users*"
        }
      ],
      "filterClause": "AND"
    }
  ],
  "groupClause": "AND",
  "pgNum": 1,
  "pgSize": 100
}'</span>
</code></pre></div><h3 id='open-a-case'>Open a case</h3>
<p>To track your investigation of the event that triggered the alert, use the <a href="/api/#operation/createCaseUsingPOST">/v1/cases</a> API command to create a case.
Only the <code>&quot;name&quot;</code> parameter is required. To leave a field blank, supply the value <code>null</code>.</p>
<div class="highlight"><pre class="highlight shell"><code>curl <span class="nt">-X</span> POST &lt;RequestURL&gt;/v1/cases <span class="se">\</span>
<span class="nt">-H</span> <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s1">'authorization: Bearer &lt;AuthToken&gt;'</span> <span class="se">\</span>
<span class="nt">-d</span> <span class="s1">'{
  "name": "Sample case name",
  "description": "Sample description",
  "findings": "Sample findings",
  "subject": "&lt;UserUID&gt;",
  "assignee": null
}'</span>
</code></pre></div>
<p>In the preceding example:</p>

<ul>
<li>Replace <code>&lt;RequestURL&gt;</code> with the <a href="/api/#section/Getting-started/Request-URLs">request URL</a> of your Code42 cloud instance.</li>
<li>Replace <code>&lt;AuthToken&gt;</code> with the <a href="/api/#section/Getting-started/Authentication">authentication token</a>.</li>
<li>Replace <code>&lt;UserUID&gt;</code> with the user UID of the person who is being investigated.</li>
</ul>

<p>Following is an example response showing the case number.</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample case name"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-10-27T15:16:05.369203Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-10-27T15:16:05.369203Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample description"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"findings"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample findings"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"subject"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"subjectUsername"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPEN"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assignee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"assigneeUsername"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdByUserUid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"806154242834341101"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"createdByUsername"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"lastModifiedByUserUid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"806154242834341101"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"lastModifiedByUsername"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user@example.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='add-file-events-to-the-case'>Add file events to the case</h3>
<p>To populate the new case with information about the alert, add file events from the alert to the case using the <a href="/api/#operation/addEventsToCaseUsingPOST">/v1/cases/&lt;CaseNumber&gt;/fileevent</a> API command.</p>
<div class="highlight"><pre class="highlight shell"><code>curl <span class="nt">-X</span> POST <span class="s1">'&lt;RequestURL&gt;/v1/cases/&lt;CaseNumber&gt;/fileevent'</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s1">'authorization: Bearer &lt;AuthToken&gt;'</span>
<span class="nt">-d</span> <span class="s1">'{"events": [
  "&lt;EventID&gt;",
  "&lt;EventID&gt;",
  ...
]}'</span>
</code></pre></div>
<p>In the preceding example:</p>

<ul>
<li>Replace <code>&lt;RequestURL&gt;</code> with the <a href="/api/#section/Getting-started/Request-URLs">request URL</a> of your Code42 cloud instance.</li>
<li>Replace <code>&lt;CaseNumber&gt;</code> with the case number shown in the response in the &quot;<a href="#view-filter-alerts">View filter alerts</a>&quot; section above.</li>
<li>Replace <code>&lt;EventID&gt;</code> values with the event IDs shown in the response in the &quot;<a href="#view-alert-details">View alert details</a>&quot; section above.</li>
<li>Replace <code>&lt;AuthToken&gt;</code> with the <a href="/api/#section/Getting-started/Authentication">authentication token</a>.</li>
</ul>

      </div>
    </div>
    <footer>
      © 2020 Code42 Software, Inc. All Rights Reserved.
      <a href="https://www.code42.com/terms-of-use/" target="_blank">Terms of use</a>
      <a href="https://www.code42.com/privacy/" target="_blank">Privacy statement</a>
    </footer>
  </body>
</html>
